<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¨¡æ¿ç¼–è¾‘å™¨ - AIæ•™æ¡ˆç”Ÿæˆç³»ç»Ÿ</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/template_editor.css') }}">
    <!-- Quill å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ -->
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
</head>
<body>
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <div class="top-navbar">
        <div class="navbar-left">
            <a href="/" class="back-btn" title="è¿”å›ä¸»é¡µ">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                    <path d="M19 12H5M5 12L12 19M5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </a>
            <div class="logo">
                <div class="logo-icon">ğŸ“</div>
                <div class="logo-text">æ¨¡æ¿ç¼–è¾‘å™¨</div>
            </div>
        </div>
        
        <div class="navbar-right">
            <button class="nav-btn" onclick="templateEditor.importTemplate()" title="å¯¼å…¥æ¨¡æ¿">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                    <path d="M21 15V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <polyline points="17,8 12,3 7,8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <line x1="12" y1="3" x2="12" y2="15" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
                <span>å¯¼å…¥</span>
            </button>
            <button class="nav-btn primary" onclick="templateEditor.saveTemplate()" title="ä¿å­˜æ¨¡æ¿">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                    <path d="M19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H16L21 8V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <polyline points="17,21 17,13 7,13 7,21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <polyline points="7,3 7,8 15,8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span>ä¿å­˜</span>
            </button>
            <button class="nav-btn success" onclick="templateEditor.downloadTemplate()" title="ä¸‹è½½ä¸ºWord">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                    <path d="M21 15V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <polyline points="7,10 12,15 17,10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <line x1="12" y1="15" x2="12" y2="3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
                <span>ä¸‹è½½</span>
            </button>
        </div>
    </div>

    <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
    <div class="editor-container">
        <!-- å·¦ä¾§ï¼šæ ‡ç­¾é¢æ¿ -->
        <div class="tags-panel">
            <div class="panel-header">
                <h3>ğŸ“‹ å¯ç”¨æ ‡ç­¾</h3>
                <div class="search-box">
                    <input type="text" id="tagSearch" placeholder="æœç´¢æ ‡ç­¾..." onkeyup="templateEditor.searchTags(this.value)">
                </div>
            </div>
            
            <div class="panel-content" id="tagsContent">
                <div class="tag-category">
                    <div class="category-header" onclick="toggleCategory(this)">
                        <span class="category-icon">â–¼</span>
                        <span class="category-title">ğŸ“Œ åŸºæœ¬ä¿¡æ¯ (7)</span>
                    </div>
                    <div class="category-content">
                        <div class="tag-item" onclick="templateEditor.insertTag('course_name')" title="è¯¾ç¨‹åç§°">
                            <span class="tag-code">{{course_name}}</span>
                            <span class="tag-desc">è¯¾ç¨‹åç§°</span>
                        </div>
                        <div class="tag-item" onclick="templateEditor.insertTag('teacher_name')" title="æˆè¯¾æ•™å¸ˆ">
                            <span class="tag-code">{{teacher_name}}</span>
                            <span class="tag-desc">æˆè¯¾æ•™å¸ˆ</span>
                        </div>
                        <div class="tag-item" onclick="templateEditor.insertTag('class_name')" title="æˆè¯¾ç­çº§">
                            <span class="tag-code">{{class_name}}</span>
                            <span class="tag-desc">æˆè¯¾ç­çº§</span>
                        </div>
                        <div class="tag-item" onclick="templateEditor.insertTag('lesson_number')" title="è¯¾æ¬¡">
                            <span class="tag-code">{{lesson_number}}</span>
                            <span class="tag-desc">è¯¾æ¬¡</span>
                        </div>
                        <div class="tag-item" onclick="templateEditor.insertTag('lesson_title')" title="è¯¾é¢˜">
                            <span class="tag-code">{{lesson_title}}</span>
                            <span class="tag-desc">è¯¾é¢˜</span>
                        </div>
                        <div class="tag-item" onclick="templateEditor.insertTag('teaching_hours')" title="å­¦æ—¶">
                            <span class="tag-code">{{teaching_hours}}</span>
                            <span class="tag-desc">å­¦æ—¶</span>
                        </div>
                        <div class="tag-item" onclick="templateEditor.insertTag('chapter_section')" title="æˆè¯¾ç« èŠ‚">
                            <span class="tag-code">{{chapter_section}}</span>
                            <span class="tag-desc">æˆè¯¾ç« èŠ‚</span>
                        </div>
                    </div>
                </div>

                <div class="tag-category">
                    <div class="category-header" onclick="toggleCategory(this)">
                        <span class="category-icon">â–¶</span>
                        <span class="category-title">ğŸ¯ æ•™å­¦ç›®æ ‡ (4)</span>
                    </div>
                    <div class="category-content" style="display: none;">
                        <div class="tag-item" onclick="templateEditor.insertTag('ideological_goals')" title="æ€æ”¿è‚²äººç›®æ ‡">
                            <span class="tag-code">{{ideological_goals}}</span>
                            <span class="tag-desc">æ€æ”¿è‚²äººç›®æ ‡</span>
                        </div>
                        <div class="tag-item" onclick="templateEditor.insertTag('knowledge_goals')" title="çŸ¥è¯†ç›®æ ‡">
                            <span class="tag-code">{{knowledge_goals}}</span>
                            <span class="tag-desc">çŸ¥è¯†ç›®æ ‡</span>
                        </div>
                        <div class="tag-item" onclick="templateEditor.insertTag('ability_goals')" title="èƒ½åŠ›ç›®æ ‡">
                            <span class="tag-code">{{ability_goals}}</span>
                            <span class="tag-desc">èƒ½åŠ›ç›®æ ‡</span>
                        </div>
                        <div class="tag-item" onclick="templateEditor.insertTag('ideological_elements')" title="æ€æ”¿å…ƒç´ ">
                            <span class="tag-code">{{ideological_elements}}</span>
                            <span class="tag-desc">æ€æ”¿å…ƒç´ </span>
                        </div>
                    </div>
                </div>

                <div class="tag-category">
                    <div class="category-header" onclick="toggleCategory(this)">
                        <span class="category-icon">â–¶</span>
                        <span class="category-title">âš¡ æ•™å­¦é‡éš¾ç‚¹ (4)</span>
                    </div>
                    <div class="category-content" style="display: none;">
                        <div class="tag-item" onclick="templateEditor.insertTag('teaching_focus')" title="æ•™å­¦é‡ç‚¹">
                            <span class="tag-code">{{teaching_focus}}</span>
                            <span class="tag-desc">æ•™å­¦é‡ç‚¹</span>
                        </div>
                        <div class="tag-item" onclick="templateEditor.insertTag('focus_solutions')" title="é‡ç‚¹è§£å†³æªæ–½">
                            <span class="tag-code">{{focus_solutions}}</span>
                            <span class="tag-desc">é‡ç‚¹è§£å†³æªæ–½</span>
                        </div>
                        <div class="tag-item" onclick="templateEditor.insertTag('teaching_difficulty')" title="æ•™å­¦éš¾ç‚¹">
                            <span class="tag-code">{{teaching_difficulty}}</span>
                            <span class="tag-desc">æ•™å­¦éš¾ç‚¹</span>
                        </div>
                        <div class="tag-item" onclick="templateEditor.insertTag('difficulty_solutions')" title="éš¾ç‚¹è§£å†³æªæ–½">
                            <span class="tag-code">{{difficulty_solutions}}</span>
                            <span class="tag-desc">éš¾ç‚¹è§£å†³æªæ–½</span>
                        </div>
                    </div>
                </div>

                <div class="tag-category">
                    <div class="category-header" onclick="toggleCategory(this)">
                        <span class="category-icon">â–¶</span>
                        <span class="category-title">ğŸ”§ æ•™å­¦æ–¹æ³• (3)</span>
                    </div>
                    <div class="category-content" style="display: none;">
                        <div class="tag-item" onclick="templateEditor.insertTag('teaching_methods')" title="æ•™æ³•">
                            <span class="tag-code">{{teaching_methods}}</span>
                            <span class="tag-desc">æ•™æ³•</span>
                        </div>
                        <div class="tag-item" onclick="templateEditor.insertTag('learning_methods')" title="å­¦æ³•">
                            <span class="tag-code">{{learning_methods}}</span>
                            <span class="tag-desc">å­¦æ³•</span>
                        </div>
                        <div class="tag-item" onclick="templateEditor.insertTag('teaching_resources')" title="æ•™å­¦èµ„æº">
                            <span class="tag-code">{{teaching_resources}}</span>
                            <span class="tag-desc">æ•™å­¦èµ„æº</span>
                        </div>
                    </div>
                </div>

                <!-- æ•™å­¦è¿‡ç¨‹ï¼š10ä¸ªç¯èŠ‚ -->
                <div class="tag-category">
                    <div class="category-header" onclick="toggleCategory(this)">
                        <span class="category-icon">â–¶</span>
                        <span class="category-title">ğŸ“š è¯¾å‰é¢„ä¹  (4)</span>
                    </div>
                    <div class="category-content" style="display: none;">
                        <div class="tag-item" onclick="templateEditor.insertTag('preview_content')">
                            <span class="tag-code">{{preview_content}}</span>
                            <span class="tag-desc">æ•™å­¦å†…å®¹</span>
                        </div>
                        <div class="tag-item" onclick="templateEditor.insertTag('preview_teacher')">
                            <span class="tag-code">{{preview_teacher}}</span>
                            <span class="tag-desc">æ•™å¸ˆæ´»åŠ¨</span>
                        </div>
                        <div class="tag-item" onclick="templateEditor.insertTag('preview_student')">
                            <span class="tag-code">{{preview_student}}</span>
                            <span class="tag-desc">å­¦ç”Ÿæ´»åŠ¨</span>
                        </div>
                        <div class="tag-item" onclick="templateEditor.insertTag('preview_intention')">
                            <span class="tag-code">{{preview_intention}}</span>
                            <span class="tag-desc">è®¾è®¡æ„å›¾</span>
                        </div>
                    </div>
                </div>

                <!-- ç»§ç»­æ·»åŠ å…¶ä»–æ•™å­¦ç¯èŠ‚... -->
                <div class="tag-info">
                    <p>ğŸ’¡ ä½¿ç”¨æç¤º</p>
                    <ul>
                        <li>ç‚¹å‡»æ ‡ç­¾å³å¯æ’å…¥åˆ°ç¼–è¾‘å™¨å…‰æ ‡ä½ç½®</li>
                        <li>æ ‡ç­¾æ ¼å¼: <code>{{æ ‡ç­¾å}}</code></li>
                        <li>ç³»ç»Ÿä¼šè‡ªåŠ¨å¡«å……å¯¹åº”å†…å®¹</li>
                        <li>å¯ä»¥åœ¨è¡¨æ ¼ã€åˆ—è¡¨ä¸­ä½¿ç”¨æ ‡ç­¾</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- ä¸­é—´ï¼šç¼–è¾‘å™¨ -->
        <div class="editor-main">
            <div class="editor-header">
                <div class="template-info">
                    <input type="text" id="templateName" class="template-name-input" placeholder="æ¨¡æ¿åç§°ï¼ˆä¾‹å¦‚ï¼šæ•™æ¡ˆæ¨¡æ¿_2025ï¼‰" value="æˆ‘çš„æ•™æ¡ˆæ¨¡æ¿">
                    <span class="tag-count">å·²ä½¿ç”¨æ ‡ç­¾: <span id="usedTagCount">0</span></span>
                </div>
                <div class="editor-toolbar">
                    <button onclick="templateEditor.insertTable()" title="æ’å…¥è¡¨æ ¼">
                        <span>ğŸ“Š è¡¨æ ¼</span>
                    </button>
                    <button onclick="templateEditor.insertList()" title="æ’å…¥åˆ—è¡¨">
                        <span>ğŸ“ åˆ—è¡¨</span>
                    </button>
                    <button onclick="templateEditor.clearEditor()" title="æ¸…ç©ºå†…å®¹">
                        <span>ğŸ—‘ï¸ æ¸…ç©º</span>
                    </button>
                </div>
            </div>
            
            <div class="editor-wrapper">
                <div id="editor"></div>
            </div>

            <div class="editor-footer">
                <span class="word-count">å­—æ•°: <span id="wordCount">0</span></span>
                <span class="status-indicator" id="statusIndicator">â— æœªä¿å­˜</span>
            </div>
        </div>

        <!-- å³ä¾§ï¼šé¢„è§ˆé¢æ¿ -->
        <div class="preview-panel">
            <div class="panel-header">
                <h3>ğŸ‘ï¸ å®æ—¶é¢„è§ˆ</h3>
                <button class="toggle-preview-btn" onclick="templateEditor.togglePreview()">
                    <span id="previewToggleIcon">â–¼</span>
                </button>
            </div>
            <div class="panel-content" id="previewContent">
                <div class="preview-wrapper">
                    <div id="previewArea" class="preview-area">
                        <p class="placeholder-text">å¼€å§‹ç¼–è¾‘ä»¥æŸ¥çœ‹é¢„è§ˆ...</p>
                    </div>
                </div>
                <div class="preview-stats">
                    <h4>ğŸ“Š æ¨¡æ¿ç»Ÿè®¡</h4>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <span class="stat-label">æ ‡ç­¾æ€»æ•°</span>
                            <span class="stat-value" id="totalTagsCount">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">å·²è¯†åˆ«</span>
                            <span class="stat-value" id="recognizedTagsCount">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">æœªè¯†åˆ«</span>
                            <span class="stat-value" id="unrecognizedTagsCount">0</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- éšè—çš„æ–‡ä»¶è¾“å…¥ -->
    <input type="file" id="importFileInput" accept=".docx" style="display: none;">

    <!-- Quillå¯Œæ–‡æœ¬ç¼–è¾‘å™¨ -->
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
    <script src="{{ url_for('static', filename='js/template_editor.js') }}"></script>
    
    <script>
        // åˆ‡æ¢åˆ†ç±»æ˜¾ç¤º
        function toggleCategory(header) {
            const icon = header.querySelector('.category-icon');
            const content = header.nextElementSibling;
            
            if (content.style.display === 'none') {
                content.style.display = 'block';
                icon.textContent = 'â–¼';
            } else {
                content.style.display = 'none';
                icon.textContent = 'â–¶';
            }
        }
    </script>
</body>
</html>

