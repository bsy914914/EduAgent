"""
Word æ¨¡æ¿å¡«å……åŠŸèƒ½æ¼”ç¤º
Template Filler Demo

æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨æ™ºèƒ½æ ‡ç­¾å¡«å……Wordæ¨¡æ¿
"""

from utils.template_filler import WordTemplateFiller
from pathlib import Path


def main():
    print("=" * 60)
    print("ğŸ“ Word æ¨¡æ¿æ™ºèƒ½å¡«å……åŠŸèƒ½æ¼”ç¤º")
    print("=" * 60)
    print()
    
    filler = WordTemplateFiller()
    
    # 1. åˆ›å»ºç¤ºä¾‹æ¨¡æ¿
    print("ğŸ“ æ­¥éª¤ 1: åˆ›å»ºç¤ºä¾‹æ¨¡æ¿")
    print("-" * 60)
    
    template_path = "æ•™æ¡ˆæ¨¡æ¿_æ™ºèƒ½æ ‡ç­¾ç‰ˆ.docx"
    if filler.create_sample_template(template_path):
        print(f"âœ… ç¤ºä¾‹æ¨¡æ¿å·²åˆ›å»ºï¼š{template_path}")
        print("   æ‚¨å¯ä»¥ç”¨ Word æ‰“å¼€æŸ¥çœ‹æ ‡ç­¾æ ¼å¼")
    print()
    
    # 2. æ˜¾ç¤ºæ ‡ç­¾ä½¿ç”¨æŒ‡å—
    print("ğŸ“– æ­¥éª¤ 2: æ ‡ç­¾ä½¿ç”¨æŒ‡å—")
    print("-" * 60)
    print(filler.get_tag_guide())
    print()
    
    # 3. æ£€æŸ¥æ¨¡æ¿æ ‡ç­¾
    print("ğŸ” æ­¥éª¤ 3: æ£€æŸ¥æ¨¡æ¿æ ‡ç­¾")
    print("-" * 60)
    
    result = filler.check_template_tags(template_path)
    if result['success']:
        print(f"âœ… æ‰¾åˆ° {result['total_tags']} ä¸ªæ ‡ç­¾")
        print(f"   è¯†åˆ«çš„æ ‡ç­¾ï¼š{', '.join(result['recognized_tags'])}")
        if result['unrecognized_tags']:
            print(f"   âš ï¸  æœªè¯†åˆ«çš„æ ‡ç­¾ï¼š{', '.join(result['unrecognized_tags'])}")
    print()
    
    # 4. å‡†å¤‡æ•™æ¡ˆæ•°æ®
    print("ğŸ“š æ­¥éª¤ 4: å‡†å¤‡æ•™æ¡ˆæ•°æ®")
    print("-" * 60)
    
    lesson_data = {
        'lesson_number': '1',
        'lesson_title': 'æ•°æ®ç»“æ„æ¦‚è¿°',
        'teaching_hours': '2',
        'teaching_objectives': {
            'çŸ¥è¯†ç›®æ ‡': [
                'æŒæ¡æ•°æ®ç»“æ„çš„åŸºæœ¬æ¦‚å¿µã€æœ¯è¯­å’Œè¡¨ç¤ºæ–¹æ³•',
                'ç†è§£æ•°æ®ç»“æ„çš„åˆ†ç±»åŠå„ç±»ç‰¹ç‚¹',
                'äº†è§£ç®—æ³•çš„åŸºæœ¬æ¦‚å¿µåŠå¤æ‚åº¦åˆ†ææ–¹æ³•',
            ],
            'èƒ½åŠ›ç›®æ ‡': [
                'èƒ½å¤Ÿåˆ†æå®é™…é—®é¢˜ä¸­çš„æ•°æ®ç»“æ„ç‰¹ç‚¹',
                'èƒ½å¤Ÿæ ¹æ®é—®é¢˜é€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„',
            ],
            'ç´ è´¨ç›®æ ‡': [
                'åŸ¹å…»æŠ½è±¡æ€ç»´èƒ½åŠ›å’Œé€»è¾‘åˆ†æèƒ½åŠ›',
                'å…»æˆç§‘å­¦ä¸¥è°¨çš„å·¥ä½œæ€åº¦',
            ]
        },
        'teaching_focus': [
            'æ•°æ®ç»“æ„çš„å®šä¹‰ä¸åˆ†ç±»',
            'é€»è¾‘ç»“æ„ä¸å­˜å‚¨ç»“æ„çš„å…³ç³»',
            'ç®—æ³•å¤æ‚åº¦çš„æ¦‚å¿µ',
        ],
        'teaching_difficulty': [
            'æ•°æ®ç»“æ„çš„æŠ½è±¡è¡¨ç¤ºæ–¹æ³•',
            'æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦çš„åˆ†æ',
        ],
        'teaching_methods': [
            'è®²æˆæ³• - è®²è§£åŸºæœ¬æ¦‚å¿µ',
            'æ¡ˆä¾‹åˆ†ææ³• - åˆ†æå®é™…åº”ç”¨',
            'è®¨è®ºæ³• - å°ç»„è®¨è®ºé—®é¢˜',
            'æ¼”ç¤ºæ³• - å±•ç¤ºæ•°æ®ç»“æ„ç¤ºä¾‹',
        ],
        'teaching_process': {
            'å¯¼å…¥ç¯èŠ‚ï¼ˆ10åˆ†é’Ÿï¼‰': [
                'å›é¡¾ç¨‹åºè®¾è®¡è¯¾ç¨‹çš„åŸºç¡€çŸ¥è¯†',
                'æå‡ºé—®é¢˜ï¼šä¸ºä»€ä¹ˆéœ€è¦ç ”ç©¶æ•°æ®ç»“æ„ï¼Ÿ',
                'å±•ç¤ºç”Ÿæ´»ä¸­çš„æ•°æ®ç»“æ„å®ä¾‹ï¼ˆå›¾ä¹¦é¦†ä¹¦æ¶ã€è¶…å¸‚æ’é˜Ÿç­‰ï¼‰',
            ],
            'æ–°è¯¾è®²æˆï¼ˆ60åˆ†é’Ÿï¼‰': [
                '1. æ•°æ®ç»“æ„çš„åŸºæœ¬æ¦‚å¿µï¼ˆ20åˆ†é’Ÿï¼‰',
                '   - æ•°æ®ã€æ•°æ®å…ƒç´ ã€æ•°æ®é¡¹',
                '   - æ•°æ®å¯¹è±¡ã€æ•°æ®ç»“æ„',
                '   - é€»è¾‘ç»“æ„ï¼šçº¿æ€§ã€æ ‘å½¢ã€å›¾å½¢ã€é›†åˆ',
                '2. å­˜å‚¨ç»“æ„ï¼ˆ20åˆ†é’Ÿï¼‰',
                '   - é¡ºåºå­˜å‚¨',
                '   - é“¾å¼å­˜å‚¨',
                '   - ç´¢å¼•å­˜å‚¨',
                '   - æ•£åˆ—å­˜å‚¨',
                '3. ç®—æ³•ä¸å¤æ‚åº¦ï¼ˆ20åˆ†é’Ÿï¼‰',
                '   - ç®—æ³•çš„å®šä¹‰å’Œç‰¹æ€§',
                '   - æ—¶é—´å¤æ‚åº¦åˆ†æ',
                '   - ç©ºé—´å¤æ‚åº¦åˆ†æ',
            ],
            'è¯¾å ‚ç»ƒä¹ ï¼ˆ15åˆ†é’Ÿï¼‰': [
                'æ¡ˆä¾‹åˆ†æï¼šå­¦ç”Ÿæˆç»©ç®¡ç†ç³»ç»Ÿçš„æ•°æ®ç»“æ„è®¾è®¡',
                'å°ç»„è®¨è®ºï¼šå¦‚ä½•é€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„ï¼Ÿ',
                'åˆ†äº«è®¨è®ºç»“æœ',
            ],
            'æ€»ç»“å›é¡¾ï¼ˆ5åˆ†é’Ÿï¼‰': [
                'å›é¡¾æœ¬èŠ‚è¯¾é‡ç‚¹å†…å®¹',
                'é¢„å‘Šä¸‹èŠ‚è¯¾å†…å®¹ï¼šçº¿æ€§è¡¨',
                'å¸ƒç½®è¯¾åä½œä¸š',
            ],
        },
        'homework': '''
1. å¤ä¹ æ•™æç¬¬ä¸€ç« ï¼Œç†è§£æ•°æ®ç»“æ„çš„åŸºæœ¬æ¦‚å¿µ
2. å®Œæˆè¯¾åä¹ é¢˜ï¼š1-3, 1-5, 1-7
3. æ€è€ƒé¢˜ï¼šåˆ†æä»¥ä¸‹åœºæ™¯åº”è¯¥ä½¿ç”¨ä»€ä¹ˆæ•°æ®ç»“æ„ï¼Ÿ
   - æµè§ˆå™¨çš„å‰è¿›åé€€åŠŸèƒ½
   - æ‰‹æœºé€šè®¯å½•
   - ç¤¾äº¤ç½‘ç»œçš„å¥½å‹å…³ç³»
4. é¢„ä¹ ä¸‹ä¸€ç« ï¼šçº¿æ€§è¡¨
''',
        'reflection': 'ï¼ˆæœ¬æ ç”±æ•™å¸ˆè¯¾åå¡«å†™ï¼‰',
    }
    
    course_data = {
        'course_name': 'æ•°æ®ç»“æ„',
        'teacher_name': 'å¼ è€å¸ˆ',
        'class_name': 'è®¡ç®—æœº2021çº§1ç­',
    }
    
    print("è¯¾ç¨‹ä¿¡æ¯ï¼š")
    print(f"  â€¢ è¯¾ç¨‹ï¼š{course_data['course_name']}")
    print(f"  â€¢ æ•™å¸ˆï¼š{course_data['teacher_name']}")
    print(f"  â€¢ ç­çº§ï¼š{course_data['class_name']}")
    print()
    print("æ•™æ¡ˆä¿¡æ¯ï¼š")
    print(f"  â€¢ è¯¾æ¬¡ï¼šç¬¬ {lesson_data['lesson_number']} æ¬¡è¯¾")
    print(f"  â€¢ è¯¾é¢˜ï¼š{lesson_data['lesson_title']}")
    print(f"  â€¢ å­¦æ—¶ï¼š{lesson_data['teaching_hours']} å­¦æ—¶")
    print()
    
    # 5. å¡«å……æ¨¡æ¿
    print("âœ¨ æ­¥éª¤ 5: å¡«å……æ¨¡æ¿")
    print("-" * 60)
    
    output_path = f"æ•™æ¡ˆ_ç¬¬{lesson_data['lesson_number']}æ¬¡è¯¾.docx"
    if filler.fill_lesson_plan(
        template_path=template_path,
        output_path=output_path,
        lesson_plan=lesson_data,
        course_info=course_data
    ):
        print(f"âœ… æ•™æ¡ˆç”ŸæˆæˆåŠŸï¼š{output_path}")
        print("   æ‚¨å¯ä»¥ç”¨ Word æ‰“å¼€æŸ¥çœ‹æ•ˆæœ")
    print()
    
    # 6. ä½¿ç”¨è¯´æ˜
    print("ğŸ’¡ ä½¿ç”¨è¯´æ˜")
    print("-" * 60)
    print("""
1. è‡ªå®šä¹‰æ¨¡æ¿
   - æ‰“å¼€ç”Ÿæˆçš„æ¨¡æ¿æ–‡ä»¶
   - æŒ‰éœ€ä¿®æ”¹æ ¼å¼å’Œå¸ƒå±€
   - åœ¨éœ€è¦å¡«å……çš„ä½ç½®æ’å…¥ {{æ ‡ç­¾å}}
   - ä¿å­˜æ¨¡æ¿

2. æ ‡ç­¾è¯­æ³•
   - ç®€å•å˜é‡ï¼š{{course_name}}
   - æ¡ä»¶åˆ¤æ–­ï¼š{% if homework %}...{% endif %}
   - å¾ªç¯åˆ—è¡¨ï¼š{% for item in items %}...{% endfor %}

3. æ‰¹é‡ç”Ÿæˆ
   - å¯ä»¥ä½¿ç”¨åŒä¸€ä¸ªæ¨¡æ¿
   - æ‰¹é‡ç”Ÿæˆå¤šä¸ªè¯¾æ¬¡çš„æ•™æ¡ˆ
   - æ¯ä¸ªæ•™æ¡ˆä½¿ç”¨ä¸åŒçš„æ•°æ®

4. é«˜çº§åŠŸèƒ½
   - æ”¯æŒè¡¨æ ¼ä¸­ä½¿ç”¨æ ‡ç­¾
   - æ”¯æŒæ–‡æœ¬æ¡†ä¸­ä½¿ç”¨æ ‡ç­¾
   - æ”¯æŒé¡µçœ‰é¡µè„šä¸­ä½¿ç”¨æ ‡ç­¾
   - æ”¯æŒå¤šçº§åˆ—è¡¨å’Œç¼–å·

å®Œæ•´æ–‡æ¡£ï¼šhttps://docxtpl.readthedocs.io/
""")
    
    print("=" * 60)
    print("ğŸ‰ æ¼”ç¤ºå®Œæˆï¼")
    print("=" * 60)


if __name__ == "__main__":
    main()

